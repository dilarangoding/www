---
import { getCollection } from "astro:content";

interface Props {
  limit?: number;
}

const { limit } = Astro.props as Props;

const collection = await getCollection("posts");
const posts = collection
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());

const list = typeof limit === "number" ? posts.slice(0, Math.max(0, limit)) : posts;

function ymd(d: Date) {
  const y = d.getFullYear();
  const m = String(d.getMonth() + 1).padStart(2, "0");
  const day = String(d.getDate()).padStart(2, "0");
  return `${y}-${m}-${day}`;
}
---
<div class="space-y-4">
  {list.map((post) => (
    <article >
      <time datetime={post.data.date.toISOString()} class="block text-sm text-gray-600">{ymd(post.data.date)}</time>
      <a href={`/posts/${post.slug}`} class="underline">{post.data.title}</a>
    </article>
  ))}
</div>
