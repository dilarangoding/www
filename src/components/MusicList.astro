---
import { getCollection } from "astro:content";

const all = await getCollection("music", ({ data }) => !data.draft);
const items = all
  .slice()
  .sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime());

const monthYear = (d: string | Date) =>
  new Date(d).toLocaleDateString("en-US", { month: "long", year: "numeric" });
---
<div class="space-y-6">
  {
    items.map(({ slug, data }) => (
      <div class="flex items-center gap-4">
        <a
          href={`/music/${slug}`}
          class="block shrink-0 h-20 w-20 min-w-[80px] overflow-hidden rounded-lg ring-1 ring-zinc-200 bg-zinc-100"
        >
          <img src={data.image} alt={data.title} class="h-full w-full object-cover m-0" loading="lazy" />
        </a>
        <div class="flex-1">
          <a href={`/music/${slug}`} class="underline text-black hover:text-black">
            {data.title}
          </a>
          <div class="text-sm text-zinc-600">
            {monthYear(data.date)}
          </div>
        </div>
      </div>
    ))
  }
</div>
